<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>PCA for Binary Image by AnkitaNaik</title>
    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/github-dark.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script src="javascripts/main.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

  </head>
  <body>

      <header>
        <h1>PCA for Binary Image</h1>
        <p>Dimensionality Reduction of an Image using Principal Component Analysis</p>
      </header>

      <div id="banner">
        <span id="logo"></span>

        <a href="https://github.com/AnkitaNaik/PCA_Images" class="button fork"><strong>View On GitHub</strong></a>
        <div class="downloads">
          <span>Downloads:</span>
          <ul>
            <li><a href="https://github.com/AnkitaNaik/PCA_Images/zipball/master" class="button">ZIP</a></li>
            <li><a href="https://github.com/AnkitaNaik/PCA_Images/tarball/master" class="button">TAR</a></li>
          </ul>
        </div>
      </div><!-- end banner -->

    <div class="wrapper">
      <nav>
        <ul></ul>
      </nav>
      <section>
        <h2>
<a id="pricipal-component-analysis-on-binary-images" class="anchor" href="#pricipal-component-analysis-on-binary-images" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Pricipal Component Analysis on Binary Images</h2>

<p>Binary Image is an image which has only two pixels ((0,0,0) and (255,255,255) i.e. black and white) comprising its body. Following code explains the effect of carrying out PCA on such an image. </p>

<h3>
<a id="python-code" class="anchor" href="#python-code" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Python Code</h3>

<p><b>Following is the input image and its corresponding data matrix:</b></p>
<p><img src="/PCA_Images/images/Image1.jpg" alt="Binary Image"></p>
<b>Converting image to RGB matrix</b>
<pre class = "code">
  from PIL import Image
  import numpy as np

  im = Image.open("image3.jpg")
  col,row = im.size
  data = np.zeros((row*col, 5))
  pixels = im.load()
  for i in range(col):
      for j in range(row):
          if(pixels[i,j] == (0,0,0)):
              r,g,b =  (0,0,0)
          else:
              r,g,b =  (1,1,1)
          data[(i*row + j),:] = r,g,b,i,j
  print(data)
</pre>
<b>Output : RGB Matrix</b>
<pre class = "code">
  [[   0.    0.    0.    0.    0.]
  [   0.    0.    0.    0.    1.]
  [   0.    0.    0.    0.    2.]
  ..., 
  [   0.    0.    0.  451.  312.]
  [   0.    0.    0.  451.  313.]
  [   0.    0.    0.  451.  314.]]
</pre>

<b> Carrying out PCA to identify variables which explain the maximum possile variance</b>
<pre class ="code">
mean_vector = np.array([[np.mean(data[:,0])],[np.mean(data[:,1])],[np.mean(data[:,2])],[np.mean(data[:,3])],[np.mean(data[:,4])]])
data_adjust = np.vstack((((data[:,0]) - mean_vector[0]),
                             ((data[:,1]) - mean_vector[1]),
                             ((data[:,2]) - mean_vector[2])
                         ))

cov_mat = np.cov(data_adjust)

# eigenvectors and eigenvalues for the from the covariance matrix
eig_val_cov, eig_vec_cov = np.linalg.eig(cov_mat)

# Make a list of (eigenvalue, eigenvector) tuples
eig_pairs = [(np.abs(eig_val_cov[i]), eig_vec_cov[:,i])
             for i in range(len(eig_val_cov))]

def getKey(item):
    return item[0]

eig_pairs.sort(key=getKey)
eig_pairs.reverse()

tot = sum(eig_val_cov)
var_exp = [(i / tot)*100 for i in sorted(eig_val_cov, reverse=True)]
print("Variance explained: \n",var_exp)
</pre>

<b>Output: </b>
<pre class ="code">
Variance explained: 
 [100.0, 0.0, 0.0]
</pre>

<b>Reconstructing the original data and saving the transformed image</b>
<pre class ="code">
matrix_w = np.array(eig_pairs[0][1].reshape(3,1))
transformed = matrix_w.T.dot(data_adjust)

original = (matrix_w.dot(transformed))+mean_vector[0:3]
original = original.T

original = np.around((original*255))

rgbArray = np.zeros(((col-2),row,3), 'uint8')
for i in range(col-2):
    for j in range(row):
        rgbArray[i,j] = original[(i*row + j),0:3]

img = Image.fromarray(rgbArray)
img.save('converted_Image1.jpg')
</pre>

<b>Final Output :</b>
<p><img src="/PCA_Images/images/converted_Image1.jpg" alt="Binary Image Transformed using PCA"></p>

<h3>
<a id="python-code" class="anchor" href="#python-code" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Few Other Images Transformed</h3>

<b>Example 1 <br></b>
<table>
  <col>
    <img src="/PCA_Images/images/Image2.jpg" alt="Binary Image Transformed using PCA">
  </col>
  <col>
    <p>--></p>
  </col>
  <col>
    <img src="/PCA_Images/images/converted_Image2.jpg" alt="Binary Image Transformed using PCA">
  </col>
</table>
<br>
<br>
<b>Example 2 <br></b>
<table>
  <col>
    <img src="/PCA_Images/images/Image3.jpg" alt="Binary Image Transformed using PCA">
  </col>
  <col></col>
  <col>
    <img src="/PCA_Images/images/converted_Image3.jpg" alt="Binary Image Transformed using PCA">
  </col>
</table>


      </section>
      <footer>
        <p>Project maintained by <a href="https://github.com/AnkitaNaik">AnkitaNaik</a></p>
        <p><small>Hosted on GitHub Pages &mdash; Theme by <a href="https://twitter.com/michigangraham">mattgraham</a></small></p>
      </footer>
    </div>
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->
    
  </body>
</html>
